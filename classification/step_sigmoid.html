<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Step vs Sigmoid Function Demo</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <style>
      body, html {
        margin: 0;
        padding: 0;
        height: 100%;
        overflow: hidden;
      }

      .container {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        height: 90vh;
      }

      .plots-container {
        display: flex;
        justify-content: center;
        align-items: stretch;
        height: 80vh;
        width: 100%;
      }

      .plot-container {
        flex: 0 0 50%;   /* each takes 50% */
        height: 100%;
        display: flex;
        flex-direction: column;
        box-sizing: border-box;
      }

      .plot-title {
        font-size: 16px;
        font-weight: bold;
        margin: 10px 0;
        text-align: center;
      }

      #plot-step,
      #plot-sigmoid {
        flex: 1 1 auto;
        width: 100%;
        height: 100%;
        min-height: 0;
      }

      .slider-container {
        display: flex;
        justify-content: center;
        align-items: center;
        margin: 20px;
      }

      .slider-group {
        display: flex;
        flex-direction: column;
        align-items: center;
        margin-right: 20px;
      }

      .footer {
        display: flex;
        justify-content: center;
        align-items: center;
        width: 100%;
        background-color: #f8f9fa;
        color: #6c757d;
        text-align: center;
        padding: 10px 0;
        margin-top: 20px;
        margin-bottom: 5vh;
      }

      .footer a {
        color: #007bff;
        text-decoration: none;
      }
      .footer a:hover {
        text-decoration: underline;
      }

      .dropdown-container {
        margin: 0 20px;
        text-align: center;
        display: flex;
        flex-direction: column;
        align-items: center;
      }
    </style>
  </head>
  <body>
    <div class="container">

      <div class="plots-container">
        <div class="plot-container">
          <div class="plot-title">Step Function</div>
          <div id="plot-step"></div>
        </div>
        <div class="plot-container">
          <div class="plot-title">Sigmoid Function</div>
          <div id="plot-sigmoid"></div>
        </div>
      </div>

      <!-- Sliders for 2D -->
      <div id="sliders-2d" class="slider-container">
        <div class="dropdown-container">
          <label for="plot-selector-2d">Choose dimension:</label>
          <select id="plot-selector-2d" onchange="switchPlot()">
            <option value="2d">1d feature</option>
            <option value="3d">2d feature</option>
          </select>
        </div>
        <div class="slider-group">
          <label for="theta">θ:</label>
          <input type="range" id="theta" min="-10" max="10" value="-3" step="0.1" oninput="updatePlots()" />
          <span id="theta_value">-3</span>
        </div>
        <div class="slider-group">
          <label for="theta_0">θ₀:</label>
          <input type="range" id="theta_0" min="-10" max="10" value="0" step="0.1" oninput="updatePlots()" />
          <span id="theta_0_value">0</span>
        </div>
      </div>

      <!-- Sliders for 3D -->
      <div id="sliders-3d" class="slider-container" style="display: none">
        <div class="dropdown-container">
          <label for="plot-selector-3d">Choose dimension:</label>
          <select id="plot-selector-3d" onchange="switchPlot()">
            <option value="2d">1d feature</option>
            <option value="3d">2d feature</option>
          </select>
        </div>
        <div class="slider-group">
          <label for="theta_1">θ₁:</label>
          <input type="range" id="theta_1" min="-10" max="10" value="-3" step="0.1" oninput="updatePlots()" />
          <span id="theta_1_value">-3</span>
        </div>
        <div class="slider-group">
          <label for="theta_2">θ₂:</label>
          <input type="range" id="theta_2" min="-10" max="10" value="1" step="0.1" oninput="updatePlots()" />
          <span id="theta_2_value">1</span>
        </div>
        <div class="slider-group">
          <label for="theta_0_3d">θ₀:</label>
          <input type="range" id="theta_0_3d" min="-10" max="10" value="0" step="0.1" oninput="updatePlots()" />
          <span id="theta_0_3d_value">0</span>
        </div>
      </div>
    </div>

    <div class="footer">
      Built with ❤️ by&nbsp;<a href="https://shenshen.mit.edu" target="_blank">Shen²</a>
      <span>&nbsp;|&nbsp;</span>
      <a href="https://github.com/shensquared/demos" target="_blank">Report a Bug</a>
    </div>

    <script>
      const fixedCameraSettings = {
        eye: { x: 1.8, y: 1.8, z: 0.3 },
        center: { x: 0, y: 0, z: 0 },
        up: { x: 0, y: 0, z: 1 },
        projection: { type: "perspective" }
      };

      const step = (x, theta, theta_0) => (theta * x + theta_0 >= 0 ? 1 : 0);
      const sigmoid = (x, theta, theta_0) => 1 / (1 + Math.exp(-(theta * x + theta_0)));
      const step3D = (x1, x2, t1, t2, t0) => (t1 * x1 + t2 * x2 + t0 >= 0 ? 1 : 0);
      const sigmoid3D = (x1, x2, t1, t2, t0) => 1 / (1 + Math.exp(-(t1 * x1 + t2 * x2 + t0)));

      function generateStepData2D(theta, theta_0) {
        let x = [], y = [];
        for (let i = -10; i <= 8; i += 0.01) {
          x.push(i);
          y.push(step(i, theta, theta_0));
        }
        return { x, y };
      }

      function generateSigmoidData2D(theta, theta_0) {
        let x = [], y = [];
        for (let i = -10; i <= 8; i += 0.01) {
          x.push(i);
          y.push(sigmoid(i, theta, theta_0));
        }
        return { x, y };
      }

      function generateVerticalLines2D(theta, theta_0) {
        if (theta === 0) return [];
        let jump = -theta_0 / theta;
        if (jump < -10 || jump > 8) return [];
        return [{
          x: [jump, jump], y: [0, 1], mode: "lines", type: "scatter",
          line: { color: "black", width: 2, dash: "dash" }, showlegend: false
        }];
      }

      function generateStepData3D(t1, t2, t0) {
        let z = [], gridX1 = [], gridX2 = [];
        for (let i = -2; i <= 2; i += 0.05) {
          gridX1.push(i); let row = [];
          for (let j = -2; j <= 2; j += 0.05) {
            if (gridX2.length < 81) gridX2.push(j);
            row.push(step3D(j, i, t1, t2, t0));
          }
          z.push(row);
        }
        return { x1: gridX1, x2: gridX2, z };
      }

      function generateSigmoidData3D(t1, t2, t0) {
        let z = [], gridX1 = [], gridX2 = [];
        for (let i = -2; i <= 2; i += 0.1) {
          gridX1.push(i); let row = [];
          for (let j = -2; j <= 2; j += 0.1) {
            if (gridX2.length < 41) gridX2.push(j);
            row.push(sigmoid3D(j, i, t1, t2, t0));
          }
          z.push(row);
        }
        return { x1: gridX1, x2: gridX2, z };
      }

      function getMode() {
        const s2dVisible = document.getElementById("sliders-2d").style.display !== "none";
        const selector = s2dVisible ? document.getElementById("plot-selector-2d")
                                    : document.getElementById("plot-selector-3d");
        return selector.value;
      }

      function updatePlots() {
        const mode = getMode();
        if (mode === "2d") {
          const theta = parseFloat(document.getElementById("theta").value);
          const theta_0 = parseFloat(document.getElementById("theta_0").value);
          
          // Update displayed values
          document.getElementById("theta_value").textContent = theta;
          document.getElementById("theta_0_value").textContent = theta_0;

          const stepData = generateStepData2D(theta, theta_0);
          const verticals = generateVerticalLines2D(theta, theta_0);
          const sigmoidData = generateSigmoidData2D(theta, theta_0);

          const testX = 2;
          const sigmoidPrediction = sigmoid(testX, theta, theta_0);
          const stepPrediction = step(testX, theta, theta_0);
          const pointColor = sigmoidPrediction > 0.5 ? "red" : "blue";

          const layout = {
            xaxis: { title: "x", range: [-10, 8] },
            yaxis: { title: "", range: [-0.1, 1.1] },
            margin: { l: 50, r: 50, t: 50, b: 50 },
            showlegend: false, autosize: true
          };

           const stepPoint = {
             x: [testX], y: [stepPrediction], mode: "markers",
             marker: { size: 20, color: pointColor, symbol: "circle", line: { color: "gold", width: 2 } },
             showlegend: false
           };

          Plotly.react("plot-step", [
            { x: stepData.x, y: stepData.y, mode: "lines", line: { width: 2 } },
            ...verticals, stepPoint
          ], { ...layout, title: "step(θx + θ₀)" }, {responsive: true});

           Plotly.react("plot-sigmoid", [
             { x: sigmoidData.x, y: sigmoidData.y, mode: "lines", line: { width: 2 } },
             { x: [testX], y: [sigmoidPrediction], mode: "markers",
               marker: { size: 20, color: pointColor, line: { color: "gold", width: 2 } }, showlegend: false }
           ], { ...layout, title: "sigmoid(θx + θ₀)" }, {responsive: true});
        } else {
          createPlots3D();
        }
      }

      function createPlots3D() {
        const t1 = parseFloat(document.getElementById("theta_1").value);
        const t2 = parseFloat(document.getElementById("theta_2").value);
        const t0 = parseFloat(document.getElementById("theta_0_3d").value);
        
        // Update displayed values
        document.getElementById("theta_1_value").textContent = t1;
        document.getElementById("theta_2_value").textContent = t2;
        document.getElementById("theta_0_3d_value").textContent = t0;

        const stepData = generateStepData3D(t1, t2, t0);
        const sigmoidData = generateSigmoidData3D(t1, t2, t0);

        const testX1 = 1, testX2 = 1;
        const sigmoidPrediction = sigmoid3D(testX1, testX2, t1, t2, t0);
        const stepPrediction = step3D(testX1, testX2, t1, t2, t0);
        const pointColor = sigmoidPrediction > 0.5 ? "red" : "blue";

        const layout = (title) => ({
          title,
          scene: {
            xaxis: { title: "x₁", range: [-2, 2] },
            yaxis: { title: "x₂", range: [-2, 2] },
            zaxis: { title, range: [-0.1, 1.1] },
            aspectmode: "cube",
            camera: fixedCameraSettings
          },
          margin: { l: 0, r: 0, t: 50, b: 0 }
        });

        const surface = (data) => ({
          x: data.x1, y: data.x2, z: data.z,
          type: "surface",
          colorscale: [[0, "rgb(0,0,255)"], [1, "rgb(255,0,0)"]],
          showscale: false
        });

        const verticalLine = (x, y) => ({
          x: [x, x], y: [y, y], z: [-0.1, 1.1],
          mode: "lines", type: "scatter3d",
          line: { color: "black", width: 3, dash: "dash" },
          showlegend: false
        });

         const testPointStep = {
           x: [testX1], y: [testX2], z: [stepPrediction],
           mode: "markers", type: "scatter3d",
           marker: { size: 20, color: pointColor, symbol: "circle", line: { color: "gold", width: 2 } },
           showlegend: false
         };

         const testPointSigmoid = {
           x: [testX1], y: [testX2], z: [sigmoidPrediction],
           mode: "markers", type: "scatter3d",
           marker: { size: 20, color: pointColor, line: { color: "gold", width: 2 } },
           showlegend: false
         };

        Plotly.react("plot-step",
          [surface(stepData), verticalLine(testX1, testX2), testPointStep],
          layout("step(θ₁x₁ + θ₂x₂ + θ₀)"), {responsive: true}
        );
        Plotly.react("plot-sigmoid",
          [surface(sigmoidData), verticalLine(testX1, testX2), testPointSigmoid],
          layout("sigmoid(θ₁x₁ + θ₂x₂ + θ₀)"), {responsive: true}
        );
      }

      function switchPlot() {
        const selector2d = document.getElementById("plot-selector-2d");
        const selector3d = document.getElementById("plot-selector-3d");
        const mode2dVisible = document.getElementById("sliders-2d").style.display !== "none";
        const activeSelector = mode2dVisible ? selector2d : selector3d;
        const mode = activeSelector.value;

        selector2d.value = mode;
        selector3d.value = mode;

        document.getElementById("sliders-2d").style.display = mode === "2d" ? "flex" : "none";
        document.getElementById("sliders-3d").style.display = mode === "3d" ? "flex" : "none";
        updatePlots();
      }

      window.onresize = () => {
        Plotly.Plots.resize(document.getElementById("plot-step"));
        Plotly.Plots.resize(document.getElementById("plot-sigmoid"));
      };

      window.onload = switchPlot;
    </script>
  </body>
</html>